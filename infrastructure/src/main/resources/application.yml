---
spring:
  application:
    name: simple-queue-management
  messages:
    basename: messages
    encoding: UTF-8
    fallback-to-system-locale: false
  mail:
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:587}
    username: ${SMTP_USER:}
    password: ${SMTP_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${SMTP_AUTH:true}
          starttls:
            enable: ${SMTP_STARTTLS:true}
    from: ${MAIL_FROM:noreply@management.knobo.no}
  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/simplequeue}
    username: ${DATABASE_USERNAME:user}
    password: ${DATABASE_PASSWORD:password}
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true
    default-schema: public

  security:
    oauth2:
      client:
        registration:
          keycloak:
            client-id: ${KEYCLOAK_CLIENT_ID}
            client-secret: ${KEYCLOAK_CLIENT_SECRET}
            authorization-grant-type: authorization_code
            scope: openid,profile,email
        provider:
          keycloak:
            issuer-uri: ${KEYCLOAK_AUTH_SERVER_URL}/realms/${KEYCLOAK_REALM}
            user-name-attribute: preferred_username
      resourceserver:
        jwt:
          issuer-uri: ${KEYCLOAK_AUTH_SERVER_URL}/realms/${KEYCLOAK_REALM}

server:
  forward-headers-strategy: native
  tomcat:
    remoteip:
      internal-proxies: '.*'

# Keycloak Admin Client configuration for managing users and roles
keycloak:
  admin:
    server-url: ${KEYCLOAK_AUTH_SERVER_URL}
    realm: ${KEYCLOAK_REALM}
    client-id: ${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}
    client-secret: ${KEYCLOAK_ADMIN_CLIENT_SECRET:}

ntfy:
  url: ${NTFY_URL:https://ntfy.knobo.no}
  server-url: ${NTFY_SERVER_URL:${ntfy.url}}
  username: ${NTFY_USERNAME:}
  password: ${NTFY_PASSWORD:}

stripe:
  secret-key: ${STRIPE_SECRET_KEY:}
  publishable-key: ${STRIPE_PUBLISHABLE_KEY:}
  webhook-secret: ${STRIPE_WEBHOOK_SECRET:}
  connect:
    webhook-secret: ${STRIPE_CONNECT_WEBHOOK_SECRET:}
    default-country: ${STRIPE_CONNECT_DEFAULT_COUNTRY:NO}
    supported-countries: ${STRIPE_CONNECT_SUPPORTED_COUNTRIES:NO,SE,DK,FI,DE,GB,US}
  prices:
    starter: ${STRIPE_PRICE_STARTER:} # discontinued
    pro: ${STRIPE_PRICE_PRO:price_1SvabYJpRTNhfgZp194NchTA}
    enterprise: ${STRIPE_PRICE_ENTERPRISE:price_1SvabqJpRTNhfgZpJjLW7uzi}

app:
  base-url: ${APP_BASE_URL:https://management.knobo.no}

logging:
  level:
    org:
      flywaydb: INFO
      springframework:
        jdbc: INFO
        security: INFO
    com:
      example:
        simplequeue: DEBUG
