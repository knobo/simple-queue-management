---
spring:
  application:
    name: simple-queue
  messages:
    basename: messages
    encoding: UTF-8
    fallback-to-system-locale: false
  mail:
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:587}
    username: ${SMTP_USER:}
    password: ${SMTP_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${SMTP_AUTH:true}
          starttls:
            enable: ${SMTP_STARTTLS:true}
    from: ${MAIL_FROM:noreply@example.com}
  datasource:
    url: jdbc:postgresql://localhost:5432/simplequeue
    username: user
    password: password
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true
    default-schema: public

  security:
    oauth2:
      client:
        registration:
          keycloak:
            client-id: ${KEYCLOAK_CLIENT_ID}
            client-secret: ${KEYCLOAK_CLIENT_SECRET}
            authorization-grant-type: authorization_code
            scope: openid,profile,email
        provider:
          keycloak:
            issuer-uri: ${KEYCLOAK_AUTH_SERVER_URL}/realms/${KEYCLOAK_REALM}
            user-name-attribute: preferred_username
      resourceserver:
        jwt:
          issuer-uri: ${KEYCLOAK_AUTH_SERVER_URL}/realms/${KEYCLOAK_REALM}

server:
  forward-headers-strategy: native
  tomcat:
    remoteip:
      internal-proxies: '.*'

# Keycloak Admin Client configuration for managing users and roles
keycloak:
  admin:
    server-url: ${KEYCLOAK_AUTH_SERVER_URL}
    realm: ${KEYCLOAK_REALM}
    client-id: ${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}
    client-secret: ${KEYCLOAK_ADMIN_CLIENT_SECRET:}

ntfy:
  url: https://ntfy.knobo.no
  username: ${NTFY_USERNAME:}
  password: ${NTFY_PASSWORD:}

stripe:
  secret-key: ${STRIPE_SECRET_KEY:}
  publishable-key: ${STRIPE_PUBLISHABLE_KEY:}
  webhook-secret: ${STRIPE_WEBHOOK_SECRET:}
  prices:
    starter: ${STRIPE_PRICE_STARTER:price_1SvabCJpRTNhfgZpd1R2of7C}
    pro: ${STRIPE_PRICE_PRO:price_1SvabYJpRTNhfgZp194NchTA}
    enterprise: ${STRIPE_PRICE_ENTERPRISE:price_1SvabqJpRTNhfgZpJjLW7uzi}

app:
  base-url: ${APP_BASE_URL:http://localhost:8080}

logging:
  level:
    org:
      flywaydb: DEBUG
      springframework:
        jdbc: DEBUG
